#!/bin/bash

# Pre-commit hook to backup tp1.ipynb as tp1_alice.ipynb in the backups folder
# Git is not very good with merge conflicts on jupyter notebooks, so this helps keep local backups of the files
# i also tried the local history, but even that plugin is not being helpfull

# Define paths
NOTEBOOK_PATH="TP2/tp2.ipynb"
BACKUP_DIR="TP2/backups"
# Get username from git config or environment
WHOAMI=$(whoami)
# Get current timestamp
TIMESTAMP=$(date +"%Y-%m-%d_%H-%M-%S")
BACKUP_FILE="$BACKUP_DIR/tp2_${WHOAMI}_${TIMESTAMP}.ipynb"

# Check if the notebook exists
if [ -f "$NOTEBOOK_PATH" ]; then
    # Create backup directory if it doesn't exist
    mkdir -p "$BACKUP_DIR"
    
    # Copy the notebook to the backup location
    cp "$NOTEBOOK_PATH" "$BACKUP_FILE"
    
    echo "Backed up $NOTEBOOK_PATH to $BACKUP_FILE"
fi

# Exit successfully to allow the commit to proceed
exit 0
